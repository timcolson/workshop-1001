---
title: Live Search Results
description: Dynamic search with debouncing as you type
---

import { Steps } from '@astrojs/starlight/components';

Wouldn't it be cool if the search results were dynamic? You're going to make that happen now!

## How It Works

<Steps>

1. Send search text (with debounce) to server
2. Get result list â€” titles & links
3. Repeat as search text changes

</Steps>

## Step 1: Add Dynamic Search Box

Open `templates/home.html` and replace the search-box div with HTMX-powered code:

```html title="templates/home.html" del={1-4} ins={5-12}
<div class="search-box">
    <form action="{{ url_for('search_recipes') }}" method="get">
        <input type="search" name="q" placeholder="Search recipes...">
    </form>
<div class="search-box">
    <input type="search"
           name="q"
           placeholder="Search recipes..."
           hx-get="{{ url_for('search_recipes') }}"
           hx-trigger="input changed delay:300ms, search"
           hx-target="#recipe-list">
</div>
</div>
```

### Understanding the HTMX Attributes

| Attribute | Purpose |
|-----------|---------|
| `hx-get` | URL to fetch search results |
| `hx-trigger` | Fires on input change with 300ms debounce, or on search event |
| `hx-target` | Element to replace with results |

:::note[Debouncing]
The `delay:300ms` prevents sending a request on every keystroke. The request fires 300ms after the user stops typing.
:::

## Step 2: Update Server Response

Similar to before, update the server to return a fragment instead of a full page.

Open `app.py` and modify the search route:

```python title="app.py" del={2} ins={3}
def search_recipes():
    return render_template('search.html', recipes=results, query=query)
    return render_template('search_results_fragment.html', recipes=results, query=query)
```

## Step 3: Create Search Results Fragment

Create a new template file: `templates/search_results_fragment.html`

```html title="templates/search_results_fragment.html"
{% if query %}
<p class="search-info">
    Found {{ recipes|length }} result{% if recipes|length != 1 %}s{% endif %}
    for "{{ query }}"
</p>
{% endif %}

{% if recipes %}
<ul class="recipe-list">
    {% for recipe in recipes %}
    <li>
        <img src="{{ recipe.get_thumbnail_image_url() }}"
             alt="{{ recipe.name }}" width="50" height="50" />
        <a href="#"
           hx-get="{{ url_for('recipe_detail', recipe_id=recipe.index) }}"
           hx-target="#recipe-details"
           hx-on::after-request="this.closest('body')
               .querySelector('#recipe-details').classList.remove('empty')">
            {{ recipe.name }}
        </a>
    </li>
    {% endfor %}
</ul>
{% elif query %}
<p class="no-results">No recipes found matching "{{ query }}"</p>
{% endif %}
```

:::tip[Success!]
You should now have dynamic search results! Type in the search box and watch results appear automatically.
:::

Next up: [Infinite Scroll](/part-2/infinite-scroll)
