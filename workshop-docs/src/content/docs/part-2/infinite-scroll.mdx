---
title: Infinite Scroll
description: Load more recipes automatically as user scrolls
---

import { Aside } from '@astrojs/starlight/components';
import { Steps, Tabs, TabItem } from '@astrojs/starlight/components';


:::caution[Side Quest]
Before you add infinite scroll, you might try upgrading **Next** and **Previous** links to use HTMX.

Currently, paging reloads the whole page. The selected recipe detail gets cleared in the process.

You have the tools to fix it with HTMX! Add HTMX to Previous/Next links, target the `#recipe-list` column, and adjust the server route to send only partial HTML.

You've seen all these steps before, so you might give it a try. Doing is learning, right? ðŸ˜Š
:::

Instead of a list of recipes, ten at a time, wouldn't automatic loading more recipes when the user scrolls to the bottom be better? It sure would!

Conceptually, you build automatic scrolling with the following steps: 

1. Add a trigger element at the bottom of the recipe list
2. When the trigger element comes into view, fetch the next page
3. Append the new page of recipes to the existing list

You'll re-use the existing paging server logic, combined with HTMX attributes:

| Attribute | Purpose |
|-----------|---------|
| `hx-get` | URL to fetch next page of recipes |
| `hx-trigger` | `intersect once` â€” fires when element intersects its viewport one time |
| `hx-swap` | `outerHTML` â€” replace the entire content of the target |


## To add infinite scroll
<Steps>
1. Update the recipe_list_items template

    Open `templates/_recipe_list_items.html` and add the following at the end

    ```html title="templates/_recipe_list_items.html" ins={1-8}
    {% if page < total_pages %}
    <li>
        <span hx-target="closest li"
        hx-trigger="intersect once"
        hx-swap="outerHTML"
        hx-get="{{ url_for('list_recipes', page=page+1, fragment=1) }}">Loading Moreâ€¦</span>
    </li>
    {% endif %}
    ```

2. Remove paging from home template

    Open `templates/home.html` and remove the pagination div:

    ```html title="templates/home.html" del={1-11}
    <div class="pagination">
        {% if page > 1 %}
        <a href="{{ url_for('list_recipes', page=page-1) }}">Previous</a>
        {% endif %}

        <span class="current">Page {{ page }} of {{ total_pages }}</span>

        {% if page < total_pages %}
        <a href="{{ url_for('list_recipes', page=page+1) }}">Next</a>
            {% endif %}
    </div>
    ```

3. Refresh the browser.

</Steps>

:::tip[Success!]
You should now have infinite scrolling!
:::


## How It Works

1. **Initial load**: Shows first 10 recipes plus a "trigger" element at the bottom
2. **User scrolls**: When trigger element becomes visible (`intersect once`), HTMX fetches next page
3. **[Transclusion](https://en.wikipedia.org/wiki/Transclusion)**: New recipes are inserted, replacing the target `<li>` with actual content + a new trigger `<li>` element.
4. **Repeat**: Process continues until no more pages

...HTMX has [triggers](https://htmx.org/attributes/hx-trigger/) for `revealed` and `intersect`. Both those triggers deal with elements becoming visible in a viewport but there are [differences](https://htmx.org/examples/infinite-scroll/).

You've completed all three HTMX upgrades! Head to [Next Steps](/workshop-1001/part-2/next-steps/) for a summary and instructions to try the Datastar approach.
